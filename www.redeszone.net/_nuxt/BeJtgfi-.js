import{y as n,z as b,A as B,J as f,i as H,o as L,q as T,B as C,p as c,k as m,C as x,T as D}from"./oPhCY1eG.js";import{r as I}from"./3J22ldtE.js";import{c as S}from"./CM8DOhej.js";import"./Bs9Xc8Tp.js";import"./CFgtQW9Z.js";import"./DkAksV3r.js";import"./BXA7Vo6b.js";import"./D7V6NYrr.js";import"./MzOL117u.js";import"./5eIYta6O.js";import"./Bnpic_8n.js";import"./BjrNffUn.js";const k=["innerHTML"],$={__name:"Progress",props:{selector:{type:String,required:!1,default:".main-header"}},setup(v){const g=v,u=S(),d=n(null);let i=n(!1),a=n(void 0),t=n({current:0,last:0,scrollDown:!1}),s=null,o=null;b(()=>{E()}),B(()=>{s&&(window.removeEventListener("scroll",s),s=null),o&&(window.removeEventListener("scroll",o),o=null)}),f(u,e=>{s&&(window.removeEventListener("scroll",s),s=null),w(e)});const w=e=>{e.postId!==void 0&&(a.value=document.getElementById(`post-${e.postId}`),a.value!==null&&h())},h=()=>{if(s)return;const e=document.getElementById("gaz-infinite-progress");s=()=>y(e),window.addEventListener("scroll",s)},y=e=>{_();const l=a.value.getBoundingClientRect();let r;t.value.scrollDown?r=l.height-window.innerHeight/2:r=l.height;let p=l.top-window.innerHeight/2,P=Math.abs(p)/r*100;I(()=>{p<0?e.style.cssText="transform: scaleX("+P/100+");":e.style.cssText="transform: scaleX(0);"})},_=()=>{t.value.current=document.documentElement.scrollTop||document.body.scrollTop,t.value.last===0&&(t.value.last=t.value.current),t.value.scrollDown=t.value.current>0&&t.value.current>t.value.last,t.value.last=t.value.current},E=()=>{o||(o=()=>{let e=window.scrollY;const l=document.querySelector(g.selector),r=l.offsetHeight+20;d.value.style.top=l.offsetHeight+"px",e=window.scrollY,i.value=e>=r},window.addEventListener("scroll",o))};return f(i,e=>{document.body.classList.toggle("has-progress",e)}),(e,l)=>(L(),H(D,null,{default:T(()=>[C(c("div",{ref_key:"postProgressRef",ref:d,class:"post-progress"},[c("div",{class:"post-progress__title",innerHTML:m(u).title},null,8,k),l[0]||(l[0]=c("div",{id:"gaz-infinite-progress",class:"post-progress__bar"},null,-1))],512),[[x,m(i)]])]),_:1}))}};export{$ as default};
